{
  "detectors_to_exclude": "similar-names,solc-version,low-level-calls,naming-convention,external-function",
  "filter_paths": "lib/|test/|script/|deprecated/",
  "exclude_informational": true,
  "exclude_low": false,
  "exclude_optimization": false,
  "exclude_medium": false,
  "exclude_high": false,
  "json": "slither-report.json",
  "triage_mode": true,
  "solc_remaps": [
    "@openzeppelin/=lib/openzeppelin-contracts/",
    "forge-std/=lib/forge-std/src/",
    "solady/=lib/solady/src/",
    "commerce-payments/=lib/commerce-payments/src/"
  ],
  "compile_force_framework": "foundry",
  "foundry_out_directory": "out",
  "show_ignored_findings": false,

  "_comment_detectors": "Detectors we're explicitly ignoring as false positives or intentional design choices",
  "_ignored_detectors": {
    "reentrancy-benign": "Reentrancy protection enforced by ReentrancyGuardTransient - false positives on recorder callbacks",
    "reentrancy-events": "Event ordering is intentional - events emitted before external calls to match Checks-Effects-Interactions",
    "timestamp": "Timestamp manipulation bounded to ~15 min, negligible for 7-day escrow periods",
    "assembly": "Solady uses assembly for gas optimization - audited library",
    "unused-return": "Some return values intentionally unused (e.g., SafeERC20 always reverts on failure)",
    "calls-loop": "External calls in loops are intentional for fee distribution - bounded by MAX_CONDITIONS",
    "similar-names": "Variable names follow consistent patterns, not confusing",
    "solc-version": "Locked to 0.8.28 for consistency",
    "low-level-calls": "SafeTransferLib uses low-level calls for gas efficiency - audited",
    "naming-convention": "Following Solidity style guide",
    "external-function": "Public functions needed for testing and flexibility"
  },

  "_comment_findings": "Specific findings that have been reviewed and accepted",
  "_accepted_findings": {
    "dangerous-strict-equality": {
      "location": "AuthCaptureEscrow._collectTokens:462",
      "reason": "INTENTIONAL - Strict equality required to reject fee-on-transfer tokens",
      "code": "if (tokenStoreBalanceAfter != tokenStoreBalanceBefore + amount) revert TokenCollectionFailed();",
      "security_impact": "Prevents accounting errors from fee-on-transfer tokens"
    },
    "timestamp-dependence": {
      "location": "EscrowPeriodCondition.check",
      "reason": "ACCEPTABLE - Timestamp manipulation bounded to ~900 seconds, negligible for multi-day escrow periods",
      "mitigation": "Document that very short escrow periods (< 1 hour) should use block numbers instead"
    },
    "reentrancy-benign": {
      "location": "PaymentOperator recorder callbacks",
      "reason": "MITIGATED - PaymentOperator now has nonReentrant guards on all functions",
      "protection": "ReentrancyGuardTransient on authorize, charge, release, refundInEscrow, refundPostEscrow"
    },
    "external-calls-loop": {
      "location": "Combinator condition checks",
      "reason": "BOUNDED - MAX_CONDITIONS = 10 enforced by CombinatorDepthChecker",
      "mitigation": "Document recommendation to keep combinator depth ≤ 5 for gas efficiency"
    }
  },

  "_comment_review_status": "Tracking review of Slither findings",
  "_review_status": {
    "high_severity": "✅ All reviewed - 0 issues found",
    "medium_severity": "✅ All reviewed - 9 findings, all false positives or intentional",
    "low_severity": "⚠️ Some benign findings accepted (naming, visibility)",
    "informational": "⚠️ Excluded from output (noise)",
    "optimization": "⚠️ Review separately for gas improvements"
  },

  "_comment_usage": "How to use this config",
  "_usage": {
    "basic": "slither . --config-file slither.config.json",
    "triage": "slither . --config-file slither.config.json --triage-mode",
    "specific_contract": "slither . --config-file slither.config.json --compile-force-framework foundry src/commerce-payments/operator/arbitration/PaymentOperator.sol",
    "generate_report": "slither . --config-file slither.config.json --json slither-report.json",
    "exclude_deps": "slither . --config-file slither.config.json --filter-paths 'lib/,test/,script/,deprecated/'",
    "check_erc20": "slither-check-erc . RewardToken --erc erc20",
    "print_summary": "slither . --config-file slither.config.json --print human-summary"
  },

  "_comment_integration": "CI/CD integration",
  "_ci_commands": {
    "github_actions": [
      "slither . --config-file slither.config.json --sarif slither.sarif",
      "Uploads SARIF to GitHub Security tab"
    ],
    "pre_commit_hook": [
      "slither . --config-file slither.config.json --exclude-optimization --exclude-informational",
      "Fails on high/medium findings only"
    ]
  },

  "_comment_maintenance": "Keep this file updated",
  "_maintenance": {
    "review_frequency": "After each audit or major change",
    "update_triggers": [
      "New Slither version",
      "New contract added",
      "Security vulnerability discovered",
      "False positive confirmed"
    ],
    "version_history": [
      {
        "date": "2026-01-25",
        "version": "1.0.0",
        "changes": "Initial configuration after token integration analysis"
      }
    ]
  }
}
